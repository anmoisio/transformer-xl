====================================================================================================
    - data : ../data/web-dsp/
    - dataset : wdtrain
    - n_layer : 32
    - n_head : 8
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 1024
    - dropout : 0.2
    - dropatt : 0.2
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.0001
    - mom : 0.0
    - scheduler : cosine
    - warmup_step : 20000
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 1200000
    - batch_size : 512
    - batch_chunk : 4
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 32
    - not_tied : False
    - seed : 1111
    - cuda : True
    - adaptive : False
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - eval_interval : 4000
    - work_dir : LM-TFM-wdtrain/20200810-114441-55036342
    - restart : False
    - restart_dir : 
    - debug : False
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : -1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - fp16 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - job_id : 55036342
    - tied : True
    - n_token : 100001
    - n_all_param : 55659041
    - n_nonemb_param : 29958144
====================================================================================================
#params = 55659041
#non emb params = 29958144
| epoch   1 step      200 |    200 batches | lr 1e-06 | ms/batch 1313.78 | loss 10.97 | ppl 58381.809
| epoch   1 step      400 |    400 batches | lr 2e-06 | ms/batch 1319.41 | loss 10.66 | ppl 42624.824
| epoch   1 step      600 |    600 batches | lr 3e-06 | ms/batch 1318.85 | loss 10.49 | ppl 35829.293
| epoch   1 step      800 |    800 batches | lr 4e-06 | ms/batch 1318.01 | loss 10.31 | ppl 29898.564
| epoch   1 step     1000 |   1000 batches | lr 5e-06 | ms/batch 1317.11 | loss 10.08 | ppl 23784.340
| epoch   1 step     1200 |   1200 batches | lr 6e-06 | ms/batch 1316.16 | loss  9.79 | ppl 17773.534
| epoch   1 step     1400 |   1400 batches | lr 7e-06 | ms/batch 1316.25 | loss  9.43 | ppl 12510.281
| epoch   1 step     1600 |   1600 batches | lr 8e-06 | ms/batch 1315.85 | loss  9.04 | ppl  8406.198
| epoch   1 step     1800 |   1800 batches | lr 9e-06 | ms/batch 1316.07 | loss  8.62 | ppl  5521.068
| epoch   1 step     2000 |   2000 batches | lr 1e-05 | ms/batch 1315.59 | loss  8.20 | ppl  3624.557
| epoch   1 step     2200 |   2200 batches | lr 1.1e-05 | ms/batch 1315.82 | loss  7.81 | ppl  2453.943
| epoch   1 step     2400 |   2400 batches | lr 1.2e-05 | ms/batch 1315.96 | loss  7.48 | ppl  1770.976
| epoch   1 step     2600 |   2600 batches | lr 1.3e-05 | ms/batch 1316.54 | loss  7.24 | ppl  1401.048
| epoch   1 step     2800 |   2800 batches | lr 1.4e-05 | ms/batch 1315.98 | loss  7.11 | ppl  1224.849
| epoch   1 step     3000 |   3000 batches | lr 1.5e-05 | ms/batch 1315.08 | loss  7.03 | ppl  1127.665
| epoch   1 step     3200 |   3200 batches | lr 1.6e-05 | ms/batch 1315.61 | loss  6.96 | ppl  1053.878
| epoch   1 step     3400 |   3400 batches | lr 1.7e-05 | ms/batch 1315.04 | loss  6.91 | ppl   999.876
| epoch   1 step     3600 |   3600 batches | lr 1.8e-05 | ms/batch 1315.66 | loss  6.86 | ppl   953.377
| epoch   1 step     3800 |   3800 batches | lr 1.9e-05 | ms/batch 1315.59 | loss  6.82 | ppl   913.625
| epoch   1 step     4000 |   4000 batches | lr 2e-05 | ms/batch 1315.80 | loss  6.79 | ppl   885.049
----------------------------------------------------------------------------------------------------
| Eval   1 at step     4000 | time: 5266.60s | valid loss  6.71 | valid ppl   823.838
----------------------------------------------------------------------------------------------------
| epoch   1 step     4200 |   4200 batches | lr 2.1e-05 | ms/batch 1329.46 | loss  6.75 | ppl   850.855
| epoch   1 step     4400 |   4400 batches | lr 2.2e-05 | ms/batch 1316.60 | loss  6.71 | ppl   823.551
| epoch   1 step     4600 |   4600 batches | lr 2.3e-05 | ms/batch 1316.57 | loss  6.68 | ppl   799.637
| epoch   1 step     4800 |   4800 batches | lr 2.4e-05 | ms/batch 1317.67 | loss  6.65 | ppl   775.470
| epoch   1 step     5000 |   5000 batches | lr 2.5e-05 | ms/batch 1317.92 | loss  6.63 | ppl   755.521
| epoch   2 step     5200 |     17 batches | lr 2.6e-05 | ms/batch 1318.35 | loss  6.60 | ppl   733.469
| epoch   2 step     5400 |    217 batches | lr 2.7e-05 | ms/batch 1319.32 | loss  6.57 | ppl   713.365
| epoch   2 step     5600 |    417 batches | lr 2.8e-05 | ms/batch 1319.44 | loss  6.55 | ppl   699.371
| epoch   2 step     5800 |    617 batches | lr 2.9e-05 | ms/batch 1319.11 | loss  6.53 | ppl   684.424
| epoch   2 step     6000 |    817 batches | lr 3e-05 | ms/batch 1318.93 | loss  6.50 | ppl   667.506
| epoch   2 step     6200 |   1017 batches | lr 3.1e-05 | ms/batch 1319.01 | loss  6.49 | ppl   655.321
| epoch   2 step     6400 |   1217 batches | lr 3.2e-05 | ms/batch 1319.44 | loss  6.47 | ppl   642.320
| epoch   2 step     6600 |   1417 batches | lr 3.3e-05 | ms/batch 1320.07 | loss  6.44 | ppl   629.040
| epoch   2 step     6800 |   1617 batches | lr 3.4e-05 | ms/batch 1319.54 | loss  6.43 | ppl   619.599
| epoch   2 step     7000 |   1817 batches | lr 3.5e-05 | ms/batch 1319.52 | loss  6.41 | ppl   605.491
| epoch   2 step     7200 |   2017 batches | lr 3.6e-05 | ms/batch 1319.40 | loss  6.39 | ppl   596.613
| epoch   2 step     7400 |   2217 batches | lr 3.7e-05 | ms/batch 1319.65 | loss  6.37 | ppl   584.657
| epoch   2 step     7600 |   2417 batches | lr 3.8e-05 | ms/batch 1320.65 | loss  6.35 | ppl   574.787
| epoch   2 step     7800 |   2617 batches | lr 3.9e-05 | ms/batch 1320.28 | loss  6.34 | ppl   565.976
| epoch   2 step     8000 |   2817 batches | lr 4e-05 | ms/batch 1319.25 | loss  6.32 | ppl   556.796
----------------------------------------------------------------------------------------------------
| Eval   2 at step     8000 | time: 5277.04s | valid loss  6.27 | valid ppl   528.036
----------------------------------------------------------------------------------------------------
| epoch   2 step     8200 |   3017 batches | lr 4.1e-05 | ms/batch 1334.24 | loss  6.31 | ppl   547.502
| epoch   2 step     8400 |   3217 batches | lr 4.2e-05 | ms/batch 1318.95 | loss  6.29 | ppl   539.967
| epoch   2 step     8600 |   3417 batches | lr 4.3e-05 | ms/batch 1319.88 | loss  6.28 | ppl   531.300
| epoch   2 step     8800 |   3617 batches | lr 4.4e-05 | ms/batch 1319.81 | loss  6.26 | ppl   521.621
| epoch   2 step     9000 |   3817 batches | lr 4.5e-05 | ms/batch 1320.05 | loss  6.24 | ppl   514.667
| epoch   2 step     9200 |   4017 batches | lr 4.6e-05 | ms/batch 1320.15 | loss  6.23 | ppl   507.489
| epoch   2 step     9400 |   4217 batches | lr 4.7e-05 | ms/batch 1319.93 | loss  6.22 | ppl   501.756
| epoch   2 step     9600 |   4417 batches | lr 4.8e-05 | ms/batch 1320.76 | loss  6.20 | ppl   492.905
| epoch   2 step     9800 |   4617 batches | lr 4.9e-05 | ms/batch 1320.07 | loss  6.19 | ppl   486.201
| epoch   2 step    10000 |   4817 batches | lr 5e-05 | ms/batch 1319.99 | loss  6.17 | ppl   480.545
| epoch   2 step    10200 |   5017 batches | lr 5.1e-05 | ms/batch 1320.06 | loss  6.16 | ppl   473.369
| epoch   3 step    10400 |     35 batches | lr 5.2e-05 | ms/batch 1320.32 | loss  6.15 | ppl   466.566
| epoch   3 step    10600 |    235 batches | lr 5.3e-05 | ms/batch 1320.09 | loss  6.13 | ppl   459.864
| epoch   3 step    10800 |    435 batches | lr 5.4e-05 | ms/batch 1319.80 | loss  6.12 | ppl   455.882
| epoch   3 step    11000 |    635 batches | lr 5.5e-05 | ms/batch 1319.74 | loss  6.10 | ppl   447.218
| epoch   3 step    11200 |    835 batches | lr 5.6e-05 | ms/batch 1320.18 | loss  6.10 | ppl   444.355
| epoch   3 step    11400 |   1035 batches | lr 5.7e-05 | ms/batch 1320.48 | loss  6.08 | ppl   437.575
| epoch   3 step    11600 |   1235 batches | lr 5.8e-05 | ms/batch 1321.39 | loss  6.08 | ppl   434.974
| epoch   3 step    11800 |   1435 batches | lr 5.9e-05 | ms/batch 1320.60 | loss  6.06 | ppl   430.430
| epoch   3 step    12000 |   1635 batches | lr 6e-05 | ms/batch 1319.32 | loss  6.05 | ppl   423.944
----------------------------------------------------------------------------------------------------
| Eval   3 at step    12000 | time: 5282.05s | valid loss  6.05 | valid ppl   422.602
----------------------------------------------------------------------------------------------------
| epoch   3 step    12200 |   1835 batches | lr 6.1e-05 | ms/batch 1334.05 | loss  6.04 | ppl   419.858
| epoch   3 step    12400 |   2035 batches | lr 6.2e-05 | ms/batch 1319.87 | loss  6.03 | ppl   415.769
| epoch   3 step    12600 |   2235 batches | lr 6.3e-05 | ms/batch 1319.90 | loss  6.02 | ppl   411.433
| epoch   3 step    12800 |   2435 batches | lr 6.4e-05 | ms/batch 1319.89 | loss  6.01 | ppl   408.021
| epoch   3 step    13000 |   2635 batches | lr 6.5e-05 | ms/batch 1320.32 | loss  6.00 | ppl   403.730
| epoch   3 step    13200 |   2835 batches | lr 6.6e-05 | ms/batch 1320.38 | loss  5.99 | ppl   400.124
| epoch   3 step    13400 |   3035 batches | lr 6.7e-05 | ms/batch 1320.47 | loss  5.98 | ppl   395.068
| epoch   3 step    13600 |   3235 batches | lr 6.8e-05 | ms/batch 1320.04 | loss  5.97 | ppl   391.799
| epoch   3 step    13800 |   3435 batches | lr 6.9e-05 | ms/batch 1320.03 | loss  5.96 | ppl   389.304
| epoch   3 step    14000 |   3635 batches | lr 7e-05 | ms/batch 1320.85 | loss  5.95 | ppl   384.220
| epoch   3 step    14200 |   3835 batches | lr 7.1e-05 | ms/batch 1321.35 | loss  5.94 | ppl   380.434
| epoch   3 step    14400 |   4035 batches | lr 7.2e-05 | ms/batch 1320.75 | loss  5.94 | ppl   378.990
| epoch   3 step    14600 |   4235 batches | lr 7.3e-05 | ms/batch 1320.38 | loss  5.92 | ppl   373.372
| epoch   3 step    14800 |   4435 batches | lr 7.4e-05 | ms/batch 1320.92 | loss  5.92 | ppl   372.177
| epoch   3 step    15000 |   4635 batches | lr 7.5e-05 | ms/batch 1320.15 | loss  5.91 | ppl   368.320
| epoch   3 step    15200 |   4835 batches | lr 7.6e-05 | ms/batch 1320.49 | loss  5.90 | ppl   366.076
| epoch   3 step    15400 |   5035 batches | lr 7.7e-05 | ms/batch 1320.59 | loss  5.89 | ppl   362.550
| epoch   4 step    15600 |     52 batches | lr 7.8e-05 | ms/batch 1321.00 | loss  5.88 | ppl   357.798
| epoch   4 step    15800 |    252 batches | lr 7.9e-05 | ms/batch 1321.27 | loss  5.86 | ppl   352.273
| epoch   4 step    16000 |    452 batches | lr 8e-05 | ms/batch 1321.34 | loss  5.86 | ppl   350.303
----------------------------------------------------------------------------------------------------
| Eval   4 at step    16000 | time: 5283.86s | valid loss  5.89 | valid ppl   362.629
----------------------------------------------------------------------------------------------------
| epoch   4 step    16200 |    652 batches | lr 8.1e-05 | ms/batch 1333.82 | loss  5.85 | ppl   347.946
| epoch   4 step    16400 |    852 batches | lr 8.2e-05 | ms/batch 1320.71 | loss  5.84 | ppl   345.231
| epoch   4 step    16600 |   1052 batches | lr 8.3e-05 | ms/batch 1320.83 | loss  5.84 | ppl   343.432
| epoch   4 step    16800 |   1252 batches | lr 8.4e-05 | ms/batch 1321.75 | loss  5.84 | ppl   342.351
| epoch   4 step    17000 |   1452 batches | lr 8.5e-05 | ms/batch 1320.83 | loss  5.82 | ppl   337.852
| epoch   4 step    17200 |   1652 batches | lr 8.6e-05 | ms/batch 1320.07 | loss  5.82 | ppl   336.824
| epoch   4 step    17400 |   1852 batches | lr 8.7e-05 | ms/batch 1319.96 | loss  5.81 | ppl   334.949
| epoch   4 step    17600 |   2052 batches | lr 8.8e-05 | ms/batch 1320.61 | loss  5.81 | ppl   332.919
| epoch   4 step    17800 |   2252 batches | lr 8.9e-05 | ms/batch 1320.65 | loss  5.80 | ppl   329.124
| epoch   4 step    18000 |   2452 batches | lr 9e-05 | ms/batch 1320.74 | loss  5.80 | ppl   329.185
| epoch   4 step    18200 |   2652 batches | lr 9.1e-05 | ms/batch 1320.57 | loss  5.79 | ppl   325.628
| epoch   4 step    18400 |   2852 batches | lr 9.2e-05 | ms/batch 1319.49 | loss  5.78 | ppl   323.259
| epoch   4 step    18600 |   3052 batches | lr 9.3e-05 | ms/batch 1320.75 | loss  5.77 | ppl   320.345
| epoch   4 step    18800 |   3252 batches | lr 9.4e-05 | ms/batch 1320.66 | loss  5.77 | ppl   320.400
| epoch   4 step    19000 |   3452 batches | lr 9.5e-05 | ms/batch 1321.16 | loss  5.76 | ppl   318.297
| epoch   4 step    19200 |   3652 batches | lr 9.6e-05 | ms/batch 1321.00 | loss  5.75 | ppl   315.248
| epoch   4 step    19400 |   3852 batches | lr 9.7e-05 | ms/batch 1321.12 | loss  5.75 | ppl   314.585
| epoch   4 step    19600 |   4052 batches | lr 9.8e-05 | ms/batch 1320.60 | loss  5.75 | ppl   313.037
| epoch   4 step    19800 |   4252 batches | lr 9.9e-05 | ms/batch 1321.33 | loss  5.74 | ppl   311.074
| epoch   4 step    20000 |   4452 batches | lr 9.99e-05 | ms/batch 1321.07 | loss  5.74 | ppl   309.719
----------------------------------------------------------------------------------------------------
| Eval   5 at step    20000 | time: 5284.60s | valid loss  5.79 | valid ppl   328.529
----------------------------------------------------------------------------------------------------
| epoch   4 step    20200 |   4652 batches | lr 9.99e-05 | ms/batch 1335.18 | loss  5.73 | ppl   308.632
| epoch   4 step    20400 |   4852 batches | lr 9.99e-05 | ms/batch 1321.30 | loss  5.72 | ppl   306.308
| epoch   4 step    20600 |   5052 batches | lr 9.99e-05 | ms/batch 1320.60 | loss  5.72 | ppl   305.292
| epoch   5 step    20800 |     70 batches | lr 9.99e-05 | ms/batch 1321.60 | loss  5.71 | ppl   301.699
| epoch   5 step    21000 |    270 batches | lr 9.99e-05 | ms/batch 1320.70 | loss  5.69 | ppl   295.380
| epoch   5 step    21200 |    470 batches | lr 9.99e-05 | ms/batch 1320.14 | loss  5.69 | ppl   295.101
| epoch   5 step    21400 |    670 batches | lr 9.99e-05 | ms/batch 1320.48 | loss  5.68 | ppl   294.035
| epoch   5 step    21600 |    870 batches | lr 9.99e-05 | ms/batch 1320.23 | loss  5.68 | ppl   292.777
| epoch   5 step    21800 |   1070 batches | lr 9.99e-05 | ms/batch 1320.19 | loss  5.68 | ppl   292.839
| epoch   5 step    22000 |   1270 batches | lr 9.99e-05 | ms/batch 1320.94 | loss  5.67 | ppl   290.977
| epoch   5 step    22200 |   1470 batches | lr 9.99e-05 | ms/batch 1320.55 | loss  5.67 | ppl   290.790
| epoch   5 step    22400 |   1670 batches | lr 9.99e-05 | ms/batch 1320.85 | loss  5.66 | ppl   288.330
| epoch   5 step    22600 |   1870 batches | lr 9.99e-05 | ms/batch 1320.84 | loss  5.66 | ppl   287.751
| epoch   5 step    22800 |   2070 batches | lr 9.99e-05 | ms/batch 1321.14 | loss  5.66 | ppl   287.322
| epoch   5 step    23000 |   2270 batches | lr 9.99e-05 | ms/batch 1321.13 | loss  5.66 | ppl   286.752
| epoch   5 step    23200 |   2470 batches | lr 9.99e-05 | ms/batch 1320.72 | loss  5.66 | ppl   286.270
| epoch   5 step    23400 |   2670 batches | lr 9.99e-05 | ms/batch 1320.41 | loss  5.65 | ppl   284.816
| epoch   5 step    23600 |   2870 batches | lr 9.99e-05 | ms/batch 1320.59 | loss  5.65 | ppl   283.372
| epoch   5 step    23800 |   3070 batches | lr 9.99e-05 | ms/batch 1321.01 | loss  5.64 | ppl   282.554
| epoch   5 step    24000 |   3270 batches | lr 9.99e-05 | ms/batch 1321.15 | loss  5.64 | ppl   281.508
----------------------------------------------------------------------------------------------------
| Eval   6 at step    24000 | time: 5284.93s | valid loss  5.73 | valid ppl   307.393
----------------------------------------------------------------------------------------------------
| epoch   5 step    24200 |   3470 batches | lr 9.99e-05 | ms/batch 1334.95 | loss  5.64 | ppl   280.722
| epoch   5 step    24400 |   3670 batches | lr 9.99e-05 | ms/batch 1321.00 | loss  5.63 | ppl   279.949
| epoch   5 step    24600 |   3870 batches | lr 9.99e-05 | ms/batch 1321.38 | loss  5.63 | ppl   279.066
| epoch   5 step    24800 |   4070 batches | lr 9.99e-05 | ms/batch 1320.29 | loss  5.63 | ppl   278.680
| epoch   5 step    25000 |   4270 batches | lr 9.99e-05 | ms/batch 1321.13 | loss  5.63 | ppl   277.424
| epoch   5 step    25200 |   4470 batches | lr 9.99e-05 | ms/batch 1320.81 | loss  5.62 | ppl   277.178
| epoch   5 step    25400 |   4670 batches | lr 9.99e-05 | ms/batch 1321.56 | loss  5.62 | ppl   275.420
| epoch   5 step    25600 |   4870 batches | lr 9.99e-05 | ms/batch 1321.56 | loss  5.62 | ppl   274.928
| epoch   5 step    25800 |   5070 batches | lr 9.99e-05 | ms/batch 1321.68 | loss  5.61 | ppl   273.447
| epoch   6 step    26000 |     88 batches | lr 9.99e-05 | ms/batch 1321.59 | loss  5.60 | ppl   270.158
| epoch   6 step    26200 |    288 batches | lr 9.99e-05 | ms/batch 1320.39 | loss  5.58 | ppl   265.344
| epoch   6 step    26400 |    488 batches | lr 9.99e-05 | ms/batch 1320.84 | loss  5.59 | ppl   266.535
| epoch   6 step    26600 |    688 batches | lr 9.99e-05 | ms/batch 1320.82 | loss  5.58 | ppl   266.109
| epoch   6 step    26800 |    888 batches | lr 9.99e-05 | ms/batch 1321.27 | loss  5.58 | ppl   266.141
